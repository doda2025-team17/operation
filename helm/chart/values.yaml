# Namespace settings
namespace:
  create: true
  name: sms-app

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

config:
  appHostPort: "8080"
  appServerPort: ""
  modelHost: ""
  modelServicePort: ""
  modelUrl: "https://github.com/doda2025-team17/model-service/releases/download/v1.0.0/model-artifacts.tar.gz"

secrets:
  smtpPassword: "CHANGE_ME_IN_HELM"

app:
  replicaCount: 2
  image:
    repository: ghcr.io/doda2025-team17/app
    tag: latest
    pullPolicy: IfNotPresent
  containerPort: 8080
  service:
    type: ClusterIP
    port: 80
    metricsPort: 8080
  resources: {}
  nodeSelector: {}
  tolerations: []
  affinity: {}
  podAnnotations: {}
  readinessProbe:
    path: /
    initialDelaySeconds: 5
    periodSeconds: 10
  livenessProbe:
    path: /
    initialDelaySeconds: 15
    periodSeconds: 20

modelService:
  replicaCount: 1
  image:
    repository: ghcr.io/doda2025-team17/model-service
    tag: latest
    pullPolicy: IfNotPresent
  containerPort: 8081
  service:
    type: ClusterIP
    port: 8081
  volume:
    enabled: true
    hostPath: /mnt/shared/models
  resources: {}
  nodeSelector: {}
  tolerations: []
  affinity: {}
  podAnnotations: {}
  readinessProbe:
    tcpSocket: true
    initialDelaySeconds: 5
    periodSeconds: 10
  livenessProbe:
    tcpSocket: true
    initialDelaySeconds: 15
    periodSeconds: 20

ingress:
  enabled: true
  className: "nginx"
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
  hosts:
    - host: sms-app.local
      paths:
        - path: /
          pathType: Prefix
  tls: []

# Monitoring / Prometheus setup
monitoring:
  enabled: true
  serviceMonitor:
    labelKey: monitoring
    labelValue: sms-app
    namespace: sms-app
  ports:
    name: metrics
  paths:
    app: /actuator/prometheus
    model: /metrics
  scrapeInterval: 15s

# Alerting
alerting:
  enabled: true
  email:
    to: "you@example.com"
    from: "noreply@example.com"
    smarthost: "smtp.gmail.com:587"
    username: "you@example.com"


kube-prometheus-stack:
  enabled: true

  alertmanager:
    enabled: true
    config:
      global:
        resolve_timeout: 5m
      route:
        receiver: default
        group_by: [ "alertname" ]
        routes:
          - matchers: [ severity = "critical" ]
            receiver: default
      receivers:
        - name: default
          email_configs:
            - to: "{{ .Values.alerting.email.to }}"
              from: "{{ .Values.alerting.email.from }}"
              smarthost: "{{ .Values.alerting.email.smarthost }}"
              auth_username: "{{ .Values.alerting.email.username }}"
              auth_password: "{{ .Values.secrets.smtpPassword }}"
              require_tls: true

  grafana:
    enabled: false
  prometheus:
    prometheusSpec:
      serviceMonitorSelector:
        matchLabels:
          monitoring: sms-app
      serviceMonitorNamespaceSelector: {}
